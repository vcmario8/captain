# 分布式存储核心范式：复制与分区的黄金组合

最近工作中碰到一些小伙伴对自己使用的存储原理不是很了解，比如如何支持无限制大表的？如何做主备同步？如何切主？数据有分片吗？哪怕看懂了，也很难给其他同学解释，因此想分享一些分布式存储学习的核心点。

相信很多人也有类似经历，看完分布式存储原理，都记不住。哪怕项目深度使用了，对原理也一知半解。导致工作中对存储方案选型没有自己的判断。

还有很多人准备面试，对自己项目中使用到的组件原理讲的很啰嗦，又提不到重点，很容易给面试官留下仅使用过不了解原理的印象。

## 分布式存储的要点：复制和分区

### 复制

有单主，无主，多主设计，绝大部分分布式存储都是单主复制，选住有两种方式。一种是 paxos/raft 做 leader 选举，另一种是靠外部 ha 组件选主，ha 组件完成选主和切主，ha 组件一般通过 zookeeper 做高可用。 复制的原理笔记在隔壁。

### 分区

有 hash 和 range 设计，大多分布式存储都是 range 设计，称之为 shard 或者 region，支持自动合并和分裂。es 这种支持检索的，其实是做了二级索引，对关键列做全局索引，搜索的时候就可以避免挨个分区遍历。 分区原理笔记在隔壁。