# 聊聊大厂面试体系之——网络

八股热门题是三次握手，四次挥手，epoll，八股的准备让你偶尔能押中几次面试，但是现在行业内卷厉害，需要脱颖而出才能确保拿下 offer。推荐大家准备下网络考察三板斧，基础概念，io 模型，lvs 负载均衡。

## 1  基础概念

需要了解网络的 cs 模型，服务器监听请求，7*24h 在线，client 按需访问 server。访问过程就是三次握手，四次挥手，client 和server 各自的链接管理。client 通过 send api 陷入内核，将应用层数据 copy 到内核，内核缓冲区满了后会返回 eagain，内核将缓冲区通过网卡驱动将数据 copy 到网卡队列，网卡将请求发往下一跳。server 端有半连接队列，sync洪泛供给等，知识点。同时双方还需要处理下断联流程，包括 time_await 的考察等。

## 2  网络 io 模型

server 是接受方，需要区分链接管理和服务处理。八股涉及最多的就是 reactor 模型，select/poll/epoll几个实现的优缺点，再拓展了解下惊群效应。

## 3 lvs 负载均衡

服务器和用户之间还隔了个外网接入，有公网 ip，公网 ip 机器称为 director，director 将请求转发给 rs（real server） 服务器。有三种实现，1）nat 方式是 director 在 tcp 层修改上下行报文的 ip 和 port，容易成为瓶颈。2）dr 方式是 director 在链路层修改 dst 的 mac 地址，不转发响应包，性能优秀，适合高并发场景；这两种方式需要确保 director 和 rs 需要保障同一局域网，保障连通性。3） 还一种方式是 tun 模式，在 ip 层之上，封装 ipip 协议后转发请求包，响应包 director 不参与，director 和 rs 需要配置ipip隧道，因为有了ip，所以支持跨局域网转发。

以上 3 种方式都需要经过内核网络协议栈，已经不满足当下互联网需求，应用层直通控制网卡，采用 dpdk 技术直接处理用户请求，通过轮询方式处理数据，可以做到零拷贝。